create schema dbMaratona;

create table usuario(id INT AUTO_INCREMENT PRIMARY KEY,
					nome VARCHAR(255) NOT NULL,
                    email varchar(255) not null,
                    avatar BLOB);

create table maratona(id INT AUTO_INCREMENT PRIMARY KEY, 
					nome VARCHAR(255) NOT NULL,
                    descricao text, qtdTimes int not null,
                    premiacao varchar(100),
                    userId int NOT NULL,
                    FOREIGN KEY (userId) REFERENCES usuario(id) ON DELETE CASCADE ON UPDATE CASCADE);
                    
create table times(id INT AUTO_INCREMENT, 
				nome varchar(255) NOT NULL ,
				escudo BLOB NOT NULL,
				abreviacao varchar(3),
				maratonaId int NOT NULL,
                PRIMARY KEY (id, maratonaId),
				FOREIGN KEY (maratonaId) REFERENCES maratona(id) ON DELETE CASCADE ON UPDATE CASCADE);
                
create table competidores(id INT AUTO_INCREMENT,
						nome varchar(255) NOT NULL,
                        timeId int NOT NULL,
                        PRIMARY KEY (id, timeId),
                        FOREIGN KEY (timeId) REFERENCES times(id) ON DELETE CASCADE ON UPDATE CASCADE);
                        
create table partida(id INT AUTO_INCREMENT,
					data_partida DATE NOT NULL,
                    horario TIME NOT NULL,
                    local_partida varchar(100) NOT NULL,
                    id_timeUm int NOT NULL,
                    id_timeDois int NOT NULL,
                    id_maratona int NOT NULL,
                    -- Talvez o momento Momento da pontuação e as Estatísticas sejam tabelas diferentes, por isso não adicionei
                    placar varchar(10) NOT NULL,
                    PRIMARY KEY (id, id_timeUm,id_timeDois,id_maratona),
                    FOREIGN KEY (id_timeUm) REFERENCES times(id) ON DELETE CASCADE ON UPDATE CASCADE,
                    FOREIGN KEY (id_timeDois) REFERENCES times(id) ON DELETE CASCADE ON UPDATE CASCADE,
                    FOREIGN KEY (id_maratona) REFERENCES maratona(id) ON DELETE CASCADE ON UPDATE CASCADE);